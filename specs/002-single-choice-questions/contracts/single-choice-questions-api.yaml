# API Contract: Single Choice Questions

## Overview
This document defines the API contract for single choice questions functionality in the exam system.

## Base Path
`/api/v1`

## Models

### SingleChoiceQuestion
```json
{
  "id": "string",
  "questionText": "string",
  "questionType": "single_choice",
  "answerOptions": [
    {
      "id": "string",
      "optionText": "string",
      "optionIndex": "integer",
      "isCorrect": "boolean"
    }
  ],
  "correctAnswerIndex": "integer",
  "gradeLevel": "string",
  "subject": "string",
  "knowledgePoint": "string",
  "createdBy": "string",
  "createdAt": "datetime",
  "updatedAt": "datetime",
  "isActive": "boolean"
}
```

### CreateSingleChoiceQuestionRequest
```json
{
  "questionText": "string",
  "answerOptions": [
    {
      "optionText": "string",
      "isCorrect": "boolean"
    }
  ],
  "gradeLevel": "string",
  "subject": "string",
  "knowledgePoint": "string"
}
```

### CreateSingleChoiceQuestionResponse
```json
{
  "success": "boolean",
  "data": {
    "id": "string",
    "questionText": "string",
    "questionType": "single_choice",
    "answerOptions": [
      {
        "id": "string",
        "optionText": "string",
        "optionIndex": "integer",
        "isCorrect": "boolean"
      }
    ],
    "correctAnswerIndex": "integer",
    "gradeLevel": "string",
    "subject": "string",
    "knowledgePoint": "string",
    "createdBy": "string",
    "createdAt": "datetime",
    "updatedAt": "datetime",
    "isActive": "boolean"
  }
}
```

### SubmitAnswerRequest
```json
{
  "questionId": "string",
  "selectedOptionIndex": "integer"
}
```

### SubmitAnswerResponse
```json
{
  "success": "boolean",
  "data": {
    "questionId": "string",
    "selectedOptionIndex": "integer",
    "isCorrect": "boolean",
    "correctAnswerIndex": "integer"
  }
}
```

## Endpoints

### Create Single Choice Question
- **Method**: `POST`
- **Path**: `/questions/single-choice`
- **Description**: Creates a new single choice question
- **Request Body**: `CreateSingleChoiceQuestionRequest`
- **Response**: `CreateSingleChoiceQuestionResponse`
- **Authentication**: Required (Teacher/Admin)
- **Validation**:
  - Must have at least 2 answer options
  - Must have exactly one correct answer
  - Answer options must be unique

### Get Single Choice Question
- **Method**: `GET`
- **Path**: `/questions/single-choice/{id}`
- **Description**: Retrieves a single choice question by ID
- **Response**: `SingleChoiceQuestion`
- **Authentication**: Required (Teacher/Student/Admin)

### Submit Single Choice Answer
- **Method**: `POST`
- **Path**: `/questions/single-choice/{id}/submit`
- **Description**: Submits an answer for a single choice question and returns grading result
- **Request Body**: `SubmitAnswerRequest`
- **Response**: `SubmitAnswerResponse`
- **Authentication**: Required (Student)
- **Validation**:
  - Selected option index must be within available options range
  - Question must be active

### Update Single Choice Question
- **Method**: `PUT`
- **Path**: `/questions/single-choice/{id}`
- **Description**: Updates an existing single choice question
- **Request Body**: `CreateSingleChoiceQuestionRequest`
- **Response**: `CreateSingleChoiceQuestionResponse`
- **Authentication**: Required (Teacher/Admin who created the question)
- **Validation**:
  - Must have at least 2 answer options
  - Must have exactly one correct answer
  - Cannot update if question is already used in active tests

### Delete Single Choice Question
- **Method**: `DELETE`
- **Path**: `/questions/single-choice/{id}`
- **Description**: Deletes a single choice question
- **Response**: `{ "success": boolean }`
- **Authentication**: Required (Teacher/Admin who created the question)
- **Validation**:
  - Cannot delete if question is used in any test

## Error Responses
All endpoints return error responses in the following format:
```json
{
  "success": false,
  "error": {
    "code": "string",
    "message": "string"
  }
}
```

### Common Error Codes
- `INVALID_REQUEST`: Request data doesn't meet validation requirements
- `UNAUTHORIZED`: User doesn't have permission to access this resource
- `NOT_FOUND`: Requested resource doesn't exist
- `ALREADY_USED`: Cannot modify/delete question that's already used in tests
- `INVALID_SELECTION`: Selected option index is out of range